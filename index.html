<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é‡œå±±ä¸‰å¤©å…©å¤œï¼šäº’å‹•æ”»ç•¥</title>
    <style>
        :root {
            --primary: #007bff;
            --accent: #ffc107;
            --bg: #f4f7f6;
            --card-bg: #ffffff;
            --text: #2d3436;
            --nav-height: 60px;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 0 0 var(--nav-height) 0; /* é ç•™åº•éƒ¨å°èˆªç©ºé–“ */
        }
        
        /* é ‚éƒ¨ Header */
        .header {
            background: linear-gradient(135deg, #0984e3, #74b9ff);
            color: white;
            padding: 20px;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header h1 { margin: 0; font-size: 20px; }
        .header p { margin: 5px 0 0; font-size: 0.85em; opacity: 0.9; }

        /* å…§å®¹å®¹å™¨ */
        .container { padding: 15px; max-width: 800px; margin: 0 auto; }
        
        /* éš±è—/é¡¯ç¤ºæ§åˆ¶ */
        .page { display: none; animation: fadeIn 0.3s; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* è¡Œç¨‹å¡ç‰‡ */
        .timeline-item {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            border-left: 4px solid var(--primary);
            position: relative;
        }
        .time { color: var(--primary); font-weight: 800; font-size: 0.9em; }
        .activity { font-weight: 700; font-size: 1.1em; margin: 5px 0; }
        .details { font-size: 0.9em; color: #636e72; margin-bottom: 10px; }
        
        /* æŒ‰éˆ•ç¾¤çµ„ */
        .action-buttons { display: flex; gap: 8px; margin-top: 10px; }
        .btn {
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.85em;
            font-weight: 600;
            cursor: pointer;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            text-decoration: none;
        }
        .btn-map { background-color: #2db400; color: white; } /* Naver Green */
        .btn-shop { background-color: #ff7675; color: white; }
        
        /* è³¼ç‰©æ¸…å–®æ¨£å¼ */
        .shop-item {
            display: flex;
            align-items: center;
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .shop-check {
            width: 24px;
            height: 24px;
            margin-right: 15px;
            cursor: pointer;
        }
        .shop-info h4 { margin: 0; font-size: 1em; }
        .shop-info span { font-size: 0.8em; color: #888; background: #eee; padding: 2px 6px; border-radius: 4px; }
        .shop-item.checked { opacity: 0.5; text-decoration: line-through; }

        /* åˆ†å¸³è¨ˆç®—æ©Ÿ */
        .calc-box {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; font-size: 0.9em; margin-bottom: 5px; font-weight: bold;}
        .input-group input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; font-size: 16px; }
        .result-box { background: #e3f2fd; padding: 15px; border-radius: 8px; text-align: center; margin-top: 10px; }

        /* åº•éƒ¨å°èˆªåˆ— */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: var(--nav-height);
            background: white;
            display: flex;
            justify-content: space-around;
            align-items: center;
            border-top: 1px solid #eee;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
            z-index: 1000;
        }
        .nav-item {
            text-align: center;
            color: #b2bec3;
            font-size: 0.75em;
            cursor: pointer;
            flex: 1;
            padding: 8px 0;
        }
        .nav-item.active { color: var(--primary); font-weight: bold; }
        .nav-icon { font-size: 1.5em; display: block; margin-bottom: 2px; }

    </style>
</head>
<body>

    <div class="header">
        <h1>ğŸ‡°ğŸ‡· é‡œå±±è¡Œ (äº’å‹•ç‰ˆ)</h1>
        <p>é»æ“Šæ™¯é»å°èˆª â€¢ è³¼ç‰©æ¸…å–®é€£å‹•</p>
    </div>

    <div class="container">
        <div id="page-schedule" class="page active">
            </div>

        <div id="page-shopping" class="page">
            <h3 style="margin-top:0">ğŸ›’ å¾…è²·æ¸…å–®</h3>
            <div id="shopping-list-container"></div>
        </div>

        <div id="page-calc" class="page">
            <div class="calc-box">
                <h3 style="margin-top:0">ğŸ’° å¿«é€Ÿåˆ†å¸³</h3>
                <div class="input-group">
                    <label>ç¸½é‡‘é¡ (éŸ“å…ƒ â‚©)</label>
                    <input type="number" id="krw-input" placeholder="ä¾‹å¦‚: 30000" inputmode="numeric">
                </div>
                <div class="input-group">
                    <label>åŒ¯ç‡ (1å°å¹£ = å¤šå°‘éŸ“å…ƒ)</label>
                    <input type="number" id="rate-input" value="41.5" inputmode="decimal">
                </div>
                <div class="input-group">
                    <label>åˆ†æ”¤äººæ•¸</label>
                    <select id="split-input" style="width:100%; padding:10px;">
                        <option value="3">3äºº</option>
                        <option value="2">2äºº</option>
                        <option value="1">1äºº</option>
                    </select>
                </div>
                <button onclick="calculate()" class="btn btn-map" style="width:100%; background:var(--primary)">è¨ˆç®—</button>
                
                <div class="result-box" id="calc-result" style="display:none;">
                    <div>ç¸½å°å¹£: <strong id="res-twd">0</strong> TWD</div>
                    <div style="font-size:1.2em; color:var(--primary); margin-top:5px;">æ¯äºº: <strong id="res-split">0</strong> TWD</div>
                </div>
            </div>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" onclick="switchPage('schedule')">
            <span class="nav-icon">ğŸ“…</span>è¡Œç¨‹
        </div>
        <div class="nav-item" onclick="switchPage('shopping')">
            <span class="nav-icon">ğŸ›ï¸</span>æ¸…å–®
        </div>
        <div class="nav-item" onclick="switchPage('calc')">
            <span class="nav-icon">ğŸ’¸</span>ç®—éŒ¢
        </div>
    </div>

<script>
    // ==========================================
    // 1. è³‡æ–™è¨­å®šå€ (ä½ å¯ä»¥åœ¨é€™è£¡æ–°å¢å…§å®¹ï¼)
    // ==========================================

    // è³¼ç‰©æ¸…å–®è³‡æ–™åº« (Tag ç”¨ä¾†å°æ‡‰è¡Œç¨‹åœ°é»)
    const shoppingData = [
        { name: "numbuzin æ•¸å­—é¢è†œ 3è™Ÿ", tag: "OY", note: "ç¾ç™½æ€¥æ•‘ç¥å™¨ï¼ŒOlive Youngå¿…è²·", bought: false },
        { name: "Cell Fusion C é˜²æ›¬æ£’", tag: "OY", note: "ä¸æ²¾æ‰‹ï¼Œéš¨æ™‚è£œæ“¦", bought: false },
        { name: "LACTO-FIT é¾æ ¹å ‚ç›Šç”ŸèŒ", tag: "OY", note: "é»ƒè‰²ç½è£ï¼Œé£¯å¾Œåƒ", bought: false },
        { name: "LACTOMEDI å¥³æ€§ç©é›ªè‰ä¹³æ¶²", tag: "OY", note: "ç§å¯†è™•è­·ç†ï¼ŒOYæœ‰çœ‹åˆ°å¯è²·", bought: false },
        { name: "Gentle Monster å¢¨é¡", tag: "Department", note: "æ–°ä¸–ç•Œç™¾è²¨ 1F", bought: false },
        { name: "HBAF æä»æœ", tag: "Mart", note: "å„ç¨®å£å‘³éƒ½è¦è²·", bought: false },
        { name: "Bada Sand å¥¶æ²¹é¤…", tag: "Department", note: "é‡œå±±é™å®šä¼´æ‰‹ç¦®", bought: false }
    ];

    // è¡Œç¨‹è³‡æ–™ (åŒ…å«å°èˆªé—œéµå­—)
    const scheduleData = [
        { day: "Day 1", title: "1/10 (äº”) è¥¿é¢ & å—æµ¦æ´", items: [
            { time: "06:10", act: "æŠµé”æ©Ÿå ´ & å¯„æ”¾è¡Œæ", nav: "Gimhae International Airport", desc: "è¨ˆç¨‹è»Šå‰å¾€è¥¿é¢é£¯åº— (ç´„â‚©20,000)" },
            { time: "09:00", act: "æ¾äº­3ä»£è±¬è‚‰æ¹¯é£¯", nav: "Songjeong 3 Generation Pork Rice Soup", desc: "å¿…åƒæ—©é¤ï¼Œå†å»æ›éŒ¢" },
            { time: "11:00", act: "ç”˜å·æ´æ–‡åŒ–æ‘", nav: "Gamcheon Culture Village", desc: "è¨ˆç¨‹è»Šå®šä½ï¼šç”˜å·å°å­¸å°é¢" },
            { time: "14:00", act: "å—æµ¦æ´ / æ¨‚å¤©ç™¾è²¨", nav: "Lotte Department Store Gwangbok", desc: "é ‚æ¨“è§€æ™¯å°ã€BIFFå»£å ´åƒå°åƒ", shopTag: "Mart" },
            { time: "18:30", act: "Old Mansion çƒ¤è‚‰", nav: "Old Mansion Busan", desc: "è¥¿é¢è€å±‹çƒ¤è‚‰" }
        ]},
        { day: "Day 2", title: "1/11 (å…­) æµ·å²¸å…¨è¦½", items: [
            { time: "09:00", act: "Skyline Luge é‡œå±±", nav: "Skyline Luge Busan", desc: "çµ•å°ä¸èƒ½é²åˆ°ï¼æ—©é»å»æ¶é ­é¦™" },
            { time: "11:30", act: "æ¨‚å¤© Premium Outlet", nav: "Lotte Premium Outlets Dongbusan", desc: "åˆé¤ & é€›è¡—" },
            { time: "14:00", act: "é’æ²™æµ¦ & çŒç±ƒé«˜æ‰‹å¹³äº¤é“", nav: "Cheongsapo", desc: "æ‹åˆ—è»Šç¶“éã€å–å’–å•¡" },
            { time: "16:30", act: "å¤©ç©ºè† å›Šåˆ—è»Š (é’æ²™æµ¦ç«™)", nav: "Blueline Park Cheongsapo Station", desc: "é ç´„æ™‚æ®µï¼Œææ—©2Få ±åˆ°" },
            { time: "17:30", act: "æ–°ä¸–ç•Œç™¾è²¨ Centum City", nav: "Shinsegae Centum City", desc: "GMå¢¨é¡ã€Bada Sand", shopTag: "Department" },
            { time: "20:30", act: "å‘³è´Šç‹é¹½çƒ¤è‚‰ (è¥¿é¢)", nav: "Matchan Deul Wang Sogeum Gui Seomyeon", desc: "å›è¥¿é¢åƒæ™šé¤" }
        ]},
        { day: "Day 3", title: "1/12 (æ—¥) å»£å®‰é‡Œ & è£œè²¨", items: [
            { time: "10:40", act: "Nasari Sigdang æµ·é®®éºµ", nav: "Nasari Sigdang Gwangalli", desc: "å»£å®‰é‡Œæ’éšŠååº—" },
            { time: "12:30", act: "å»£å®‰é‡Œæµ·æ°´æµ´å ´", nav: "Gwangalli Beach", desc: "æ‹å»£å®‰å¤§æ©‹ã€å’–å•¡å»³" },
            { time: "15:00", act: "è¥¿é¢ Olive Young ç¸½æƒè²¨", nav: "Olive Young Seomyeon", desc: "æœ€å¾Œè£œè²¨æ©Ÿæœƒï¼", shopTag: "OY" },
            { time: "18:30", act: "å‰å¾€æ©Ÿå ´", nav: "Gimhae International Airport", desc: "é ç•™45åˆ†é˜è»Šç¨‹" }
        ]}
    ];

    // ==========================================
    // 2. ç¨‹å¼é‚è¼¯å€ (è‡ªå‹•åŸ·è¡Œ)
    // ==========================================

    // åˆå§‹åŒ–æ¸²æŸ“
    function init() {
        renderSchedule();
        renderShoppingList("All");
    }

    // æ¸²æŸ“è¡Œç¨‹
    function renderSchedule() {
        const container = document.getElementById('page-schedule');
        let html = '';
        
        scheduleData.forEach(day => {
            html += `<h3 style="margin-top:20px; border-bottom:2px solid #ddd; padding-bottom:5px;">${day.title}</h3>`;
            day.items.forEach(item => {
                let buttons = '';
                // å°èˆªæŒ‰éˆ•
                if(item.nav) {
                    buttons += `<a href="nmap://search?query=${encodeURIComponent(item.nav)}" class="btn btn-map">ğŸš• å°èˆª</a>`;
                }
                // è³¼ç‰©æŒ‰éˆ•
                if(item.shopTag) {
                    buttons += `<div onclick="filterShop('${item.shopTag}')" class="btn btn-shop">ğŸ›ï¸ å¿…è²·æ¸…å–®</div>`;
                }

                html += `
                    <div class="timeline-item">
                        <div class="time">${item.time}</div>
                        <div class="activity">${item.act}</div>
                        <div class="details">${item.desc}</div>
                        <div class="action-buttons">${buttons}</div>
                    </div>
                `;
            });
        });
        container.innerHTML = html;
    }

    // æ¸²æŸ“è³¼ç‰©æ¸…å–®
    function renderShoppingList(filterTag) {
        const container = document.getElementById('shopping-list-container');
        container.innerHTML = '';
        
        // ç¯©é¸é‚è¼¯
        const list = filterTag === "All" ? shoppingData : shoppingData.filter(i => i.tag === filterTag);
        
        if(filterTag !== "All") {
            container.innerHTML = `<div style="margin-bottom:10px;"><button onclick="renderShoppingList('All')" style="padding:5px 10px;">â¬…ï¸ é¡¯ç¤ºå…¨éƒ¨å•†å“</button></div>`;
        }

        list.forEach((item, index) => {
            const checkedClass = item.bought ? 'checked' : '';
            const checkState = item.bought ? 'checked' : '';
            
            const div = document.createElement('div');
            div.className = `shop-item ${checkedClass}`;
            div.innerHTML = `
                <input type="checkbox" class="shop-check" ${checkState} onchange="toggleBuy(${index})">
                <div class="shop-info">
                    <h4>${item.name}</h4>
                    <div style="margin-top:4px;"><span>${item.tag}</span> <span style="background:none; color:#666; padding:0;">${item.note}</span></div>
                </div>
            `;
            container.appendChild(div);
        });
    }

    // åˆ‡æ›å·²è²·ç‹€æ…‹
    function toggleBuy(index) {
        // æ³¨æ„ï¼šé€™è£¡åªæœƒæš«æ™‚ä¿®æ”¹è¨˜æ†¶é«”ä¸­çš„ç‹€æ…‹ï¼Œé‡æ•´å¾Œæœƒé‡ç½® (éœæ…‹ç‰ˆé™åˆ¶)
        shoppingData[index].bought = !shoppingData[index].bought;
        const currentFilter = document.querySelector('#shopping-list-container button') ? 
                              shoppingData[index].tag : "All";
        renderShoppingList(currentFilter);
    }

    // è·³è½‰åˆ°è³¼ç‰©é ä¸¦ç¯©é¸
    function filterShop(tag) {
        switchPage('shopping');
        renderShoppingList(tag);
    }

    // åˆ‡æ›é é¢ Tab
    function switchPage(pageId) {
        document.querySelectorAll('.page').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        
        document.getElementById(`page-${pageId}`).classList.add('active');
        
        // æ›´æ–°åº•éƒ¨å°èˆªç‹€æ…‹
        if(pageId === 'schedule') document.querySelectorAll('.nav-item')[0].classList.add('active');
        if(pageId === 'shopping') document.querySelectorAll('.nav-item')[1].classList.add('active');
        if(pageId === 'calc') document.querySelectorAll('.nav-item')[2].classList.add('active');
        
        window.scrollTo(0,0);
    }

    // è¨ˆç®—æ©Ÿé‚è¼¯
    function calculate() {
        const amount = parseFloat(document.getElementById('krw-input').value);
        const rate = parseFloat(document.getElementById('rate-input').value);
        const people = parseInt(document.getElementById('split-input').value);

        if(isNaN(amount) || isNaN(rate)) {
            alert("è«‹è¼¸å…¥æ­£ç¢ºæ•¸å­—");
            return;
        }

        const totalTWD = Math.round(amount / rate);
        const perPerson = Math.round(totalTWD / people);

        document.getElementById('res-twd').innerText = totalTWD;
        document.getElementById('res-split').innerText = perPerson;
        document.getElementById('calc-result').style.display = 'block';
    }

    // å•Ÿå‹•
    init();

</script>
</body>
</html>
